{% extends "base.html" %}

{% block title %}PQPGP Web Interface - Home{% endblock %}

{% block content %}
<div class="card">
    <h2>Welcome to PQPGP Web Interface</h2>
    <p>PQPGP is a post-quantum secure implementation of PGP (Pretty Good Privacy) that provides quantum-resistant cryptographic operations while maintaining compatibility with standard PGP workflows.</p>
    
    <h3><svg class="icon icon-lg" viewBox="0 0 24 24" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg>Security Features</h3>
    <ul>
        <li><strong>Post-Quantum Cryptography:</strong> Uses NIST-standardized ML-KEM-1024 and ML-DSA-87 algorithms</li>
        <li><strong>Hybrid Approach:</strong> Combines classical and post-quantum algorithms for maximum security</li>
        <li><strong>PGP Compatible:</strong> Standard PGP packet formats (RFC 4880) with new algorithm identifiers</li>
        <li><strong>Production Security:</strong> Comprehensive input validation, rate limiting, and attack prevention</li>
    </ul>

    <h3><svg class="icon icon-lg" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>Available Operations</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-top: 20px;">
        <div style="padding: 20px; background: var(--bg-subtle); border-radius: 8px; border-left: 4px solid var(--red-light); display: flex; flex-direction: column;">
            <h4 style="margin-top: 0; color: var(--text-dark); display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M12.65 10A5.99 5.99 0 0 0 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6a5.99 5.99 0 0 0 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>Key Management</h4>
            <p style="flex-grow: 1;">Generate and manage NIST-standardized post-quantum cryptographic keys. ML-KEM-1024 for quantum-resistant encryption and ML-DSA-87 for quantum-resistant signatures.</p>
            <a href="/keys" class="btn btn-small">Manage Keys</a>
        </div>

        <div style="padding: 20px; background: var(--bg-subtle); border-radius: 8px; border-left: 4px solid #48bb78; display: flex; flex-direction: column;">
            <h4 style="margin-top: 0; color: var(--text-dark); display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>Encryption</h4>
            <p style="flex-grow: 1;">Encrypt messages using quantum-resistant algorithms. Your data will be secure against both classical and quantum attacks.</p>
            <a href="/encrypt" class="btn btn-small">Encrypt Message</a>
        </div>

        <div style="padding: 20px; background: var(--bg-subtle); border-radius: 8px; border-left: 4px solid #ed8936; display: flex; flex-direction: column;">
            <h4 style="margin-top: 0; color: var(--text-dark); display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M12 17c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm6-9h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6h1.9c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm0 12H6V10h12v10z"/></svg>Decryption</h4>
            <p style="flex-grow: 1;">Decrypt messages that were encrypted for your public keys. Supports automatic key detection and hybrid decryption.</p>
            <a href="/decrypt" class="btn btn-small">Decrypt Message</a>
        </div>

        <div style="padding: 20px; background: var(--bg-subtle); border-radius: 8px; border-left: 4px solid #9f7aea; display: flex; flex-direction: column;">
            <h4 style="margin-top: 0; color: var(--text-dark); display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>Digital Signatures</h4>
            <p style="flex-grow: 1;">Create quantum-resistant digital signatures to prove authenticity and integrity of your messages and documents.</p>
            <a href="/sign" class="btn btn-small">Sign Message</a>
        </div>

        <div style="padding: 20px; background: var(--bg-subtle); border-radius: 8px; border-left: 4px solid #38b2ac; display: flex; flex-direction: column;">
            <h4 style="margin-top: 0; color: var(--text-dark); display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/></svg>Signature Verification</h4>
            <p style="flex-grow: 1;">Verify digital signatures to ensure message authenticity and detect any tampering or forgery attempts.</p>
            <a href="/verify" class="btn btn-small">Verify Signature</a>
        </div>
    </div>
</div>

<div class="card">
    <h2><svg class="icon icon-lg" viewBox="0 0 24 24" fill="currentColor"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>Cryptographic Algorithms</h2>
    <p>PQPGP uses state-of-the-art post-quantum and classical cryptographic algorithms to ensure maximum security against both current and future threats.</p>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px;">
        <div style="padding: 20px; background: linear-gradient(135deg, #bee3f8 0%, #e6fffa 100%); border-radius: 8px; border-left: 4px solid #3182ce;">
            <h4 style="margin-top: 0; color: #1a365d; display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>ML-KEM-1024</h4>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Purpose:</strong> Key Encapsulation Mechanism</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Use Case:</strong> Public key encryption</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Public Key Size:</strong> 1,568 bytes</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Standard:</strong> NIST FIPS 203</p>
            <p style="margin-bottom: 8px; line-height: 1.3;"><strong>Security Level:</strong> AES-256 equivalent</p>
            <p style="margin-bottom: 0; font-size: 14px; color: #2a4365;">Quantum-resistant lattice-based cryptography</p>
        </div>
        
        <div style="padding: 20px; background: linear-gradient(135deg, #e6fffa 0%, #f0fff4 100%); border-radius: 8px; border-left: 4px solid #38a169;">
            <h4 style="margin-top: 0; color: #1a202c; display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04a.996.996 0 0 0 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>ML-DSA-87</h4>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Purpose:</strong> Digital Signature Algorithm</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Use Case:</strong> Message authentication</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Public Key Size:</strong> 1,952 bytes</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Standard:</strong> NIST FIPS 204</p>
            <p style="margin-bottom: 8px; line-height: 1.3;"><strong>Security Level:</strong> AES-256 equivalent</p>
            <p style="margin-bottom: 0; font-size: 14px; color: #22543d;">Quantum-resistant lattice-based cryptography</p>
        </div>
        
        <div style="padding: 20px; background: linear-gradient(135deg, #fed7d7 0%, #fef5e7 100%); border-radius: 8px; border-left: 4px solid #e53e3e;">
            <h4 style="margin-top: 0; color: #742a2a; display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 6c1.4 0 2.8 1.1 2.8 2.5V11c.6.3 1 .9 1 1.5v3c0 1-.8 1.8-1.8 1.8h-4c-1 0-1.8-.8-1.8-1.8v-3c0-.6.4-1.2 1-1.5V9.5C9.2 8.1 10.6 7 12 7zm0 1.2c-.8 0-1.5.7-1.5 1.3V11h3V9.5c0-.6-.7-1.3-1.5-1.3z"/></svg>Argon2id + AES-256-GCM</h4>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Purpose:</strong> Password-Based Key Derivation + Encryption</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Use Case:</strong> Private key protection</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Key Size:</strong> 256-bit (32 bytes)</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Standard:</strong> RFC 9106 + NIST SP 800-38D</p>
            <p style="margin-bottom: 8px; line-height: 1.3;"><strong>Security Level:</strong> AES-256 equivalent</p>
            <p style="margin-bottom: 0; font-size: 14px; color: #744210;">Memory-hard key derivation + authenticated encryption</p>
        </div>
        
        <div style="padding: 20px; background: linear-gradient(135deg, var(--border-light) 0%, #edf2f7 100%); border-radius: 8px; border-left: 4px solid var(--text-dark);">
            <h4 style="margin-top: 0; color: #2d3748; display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M13 2.05v3.03c3.39.49 6 3.39 6 6.92 0 .9-.18 1.75-.48 2.54l2.6 1.53c.56-1.24.88-2.62.88-4.07 0-5.18-3.95-9.45-9-9.95zM12 19c-3.87 0-7-3.13-7-7 0-3.53 2.61-6.43 6-6.92V2.05c-5.06.5-9 4.76-9 9.95 0 5.52 4.47 10 9.99 10 3.31 0 6.24-1.61 8.06-4.09l-2.6-1.53C16.17 17.98 14.21 19 12 19z"/></svg>SHA3-512</h4>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Purpose:</strong> Cryptographic Hash Function</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Use Case:</strong> Message integrity & signatures</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Output Size:</strong> 512-bit (64 bytes)</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Standard:</strong> NIST FIPS 202</p>
            <p style="margin-bottom: 8px; line-height: 1.3;"><strong>Security Level:</strong> AES-256 equivalent</p>
            <p style="margin-bottom: 0; font-size: 14px; color: var(--text-dark);">Quantum-resistant Keccak sponge construction</p>
        </div>
        
        <div style="padding: 20px; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); border-radius: 8px; border-left: 4px solid #0284c7;">
            <h4 style="margin-top: 0; color: #0c4a6e; display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M12.65 10A5.99 5.99 0 0 0 7 6c-3.31 0-6 2.69-6 6s2.69 6 6 6a5.99 5.99 0 0 0 5.65-4H17v4h4v-4h2v-4H12.65zM7 14c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/></svg>HKDF-SHA3-512</h4>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Purpose:</strong> HMAC-based Key Derivation Function</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Use Case:</strong> Secure key & nonce derivation</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Input:</strong> ML-KEM shared secret</p>
            <p style="margin-bottom: 3px; line-height: 1.3;"><strong>Standard:</strong> RFC 5869 with SHA3-512</p>
            <p style="margin-bottom: 8px; line-height: 1.3;"><strong>Security:</strong> Forward-secure key expansion</p>
            <p style="margin-bottom: 0; font-size: 14px; color: #0c4a6e;">Deterministic nonce generation eliminates reuse vulnerabilities</p>
        </div>
    </div>
    
    <div style="margin-top: 25px; padding: 18px; background-color: #fffbf0; border: 1px solid #fbd38d; border-radius: 8px;">
        <h4 style="margin-top: 0; color: #744210; display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg>Post-Quantum Security</h4>
        <p style="margin-bottom: 12px; color: #744210;">All algorithms have been selected for their resistance to both classical and quantum computer attacks:</p>
        <ul style="margin-bottom: 0; color: #744210;">
            <li><strong>Quantum-resistant:</strong> ML-KEM-1024 and ML-DSA-87 are designed to withstand attacks from quantum computers</li>
            <li><strong>NIST approved:</strong> Both post-quantum algorithms are part of the NIST Post-Quantum Cryptography standards</li>
            <li><strong>Battle-tested:</strong> SHA3-512, AES-256-GCM, and HKDF are proven cryptographic primitives</li>
            <li><strong>Defense in depth:</strong> Multiple algorithms provide layered security protection</li>
        </ul>
    </div>
    
    <div style="margin-top: 20px; padding: 18px; background-color: #f0f9ff; border: 1px solid #7dd3fc; border-radius: 8px;">
        <h4 style="margin-top: 0; color: #0c4a6e; display: flex; align-items: center;"><svg class="icon icon-lg" style="margin-right: 8px;" viewBox="0 0 24 24" fill="currentColor"><path d="M18 8h-1V6c0-2.76-2.24-5-5-5S7 3.24 7 6v2H6c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V10c0-1.1-.9-2-2-2zm-6 9c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm3.1-9H8.9V6c0-1.71 1.39-3.1 3.1-3.1 1.71 0 3.1 1.39 3.1 3.1v2z"/></svg>Advanced Key Derivation Security</h4>
        <p style="margin-bottom: 12px; color: #0c4a6e;">PQPGP implements cutting-edge key derivation techniques that eliminate common cryptographic vulnerabilities:</p>
        <ul style="margin-bottom: 0; color: #0c4a6e;">
            <li><strong>Deterministic Nonce Generation:</strong> HKDF-derived nonces eliminate catastrophic nonce reuse attacks</li>
            <li><strong>Perfect Forward Secrecy:</strong> Each message gets unique keys derived from the ML-KEM shared secret</li>
            <li><strong>Domain Separation:</strong> Different contexts produce completely different keys and nonces</li>
            <li><strong>Cryptographic Binding:</strong> Keys are bound to recipient identity and KEM ciphertext to prevent substitution attacks</li>
            <li><strong>No Random Number Dependencies:</strong> Deterministic derivation eliminates weak RNG vulnerabilities</li>
        </ul>
    </div>
</div>

<div class="card">
    <h2><svg class="icon icon-lg" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>Quantum Threat Timeline</h2>
    <p>Current estimates suggest large-scale quantum computers capable of breaking RSA and ECDSA may emerge within 10-30 years. PQPGP provides:</p>
    <ul>
        <li><strong>Immediate Protection:</strong> Deploy quantum-resistant cryptography today</li>
        <li><strong>Hybrid Security:</strong> Classical algorithms provide current security, post-quantum algorithms provide future protection</li>
        <li><strong>Smooth Migration:</strong> PGP-compatible format allows gradual ecosystem transition</li>
    </ul>
</div>
{% endblock %}